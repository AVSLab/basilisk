

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>scenarioTwoChargedSC &mdash; Basilisk 2.9.0
 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=57a44e8a" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=182a64a0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=3cd7d658"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CFB87C" >

          
          
          <a href="../index.html" class="icon icon-home">
            Basilisk
              <img src="../_static/Basilisk-Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basilisk:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Build.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Learn.html">Learning Basilisk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supportData.html">Support Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExternalSites.html">External Sites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vizard:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/Vizard.html">About Vizard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardDownload.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardGUI.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/vizardAdvanced/index.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/vizardGallery.html">Video Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #CFB87C" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Basilisk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">scenarioTwoChargedSC</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for scenarioTwoChargedSC</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  ISC License</span>
<span class="c1">#</span>
<span class="c1">#  Copyright (c) 2022, Autonomous Vehicle Systems Lab, University of Colorado at Boulder</span>
<span class="c1">#</span>
<span class="c1">#  Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="c1">#  purpose with or without fee is hereby granted, provided that the above</span>
<span class="c1">#  copyright notice and this permission notice appear in all copies.</span>
<span class="c1">#</span>
<span class="c1">#  THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="c1">#  WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="c1">#  MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="c1">#  ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="c1">#  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="c1">#  ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="c1">#  OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="c1">#</span>

<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Overview</span>
<span class="sd">--------</span>

<span class="sd">Demonstrates the interaction between two charged spacecraft in a leader/follower configuration, the effect electrostatic forces/torques have on the separation of the two spacecrafts and how to visualize the simulation data in :ref:`Vizard &lt;vizard&gt;`. The scenario demonstrates how to use :ref:`msmForceTorque` to calculate the electrostatic forces using the Multi-Sphere Method. Each spacecraft is represented by multiple spheres each with a designated location and radius. The locations and radii data is stored in ``GOESR_bus_80_sphs.csv``, however any appropriate csv file can be used. Both spacecraft have a negative charged potential. The purpose of this script is to show how to set up the Multi-Sphere Method for charged spacecraft and apply the external forces/torques to the spacecrafts as well as to show how to store the Basilisk simulation data to be able to visualize both satellite&#39;s motions within the :ref:`Vizard &lt;vizard&gt;` application.</span>

<span class="sd">The script is found in the folder ``basilisk/examples`` and executed by using::</span>

<span class="sd">      python3 scenarioTwoChargedSC.py</span>

<span class="sd">The simulation layout is shown in the following illustration.  A single simulation process is created</span>
<span class="sd">which contains both the leader spacecraft and the follower object as well as the multisphere model for each of the spacecrafts.</span>

<span class="sd">.. image:: /_images/static/test_scenarioTwoChargedSC.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">When the simulation completes, several plots are shown for the separation distance of the two satellites, the relative orbit of the follower spacecraft around the leader spacecraft, and the Multisphere Model representation for both spacecraft with a color bar that denotes charge of the spheres.</span>

<span class="sd">Illustration of Simulation Results</span>
<span class="sd">----------------------------------</span>

<span class="sd">::</span>

<span class="sd">    show_plots = True</span>

<span class="sd">.. image:: /_images/Scenarios/scenarioTwoChargedSC1.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenarioTwoChargedSC2.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenarioTwoChargedSC3.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenarioTwoChargedSC4.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#</span>
<span class="c1"># Basilisk Scenario Script and Integrated Test</span>
<span class="c1">#</span>
<span class="c1"># Purpose:  Basic simulation showing two charged spacecraft interacting based on the Multisphere Sphere Method.</span>
<span class="c1"># Author:   James Walker</span>
<span class="c1"># Creation Date:  January 19, 2022</span>
<span class="c1">#</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Basilisk.architecture</span><span class="w"> </span><span class="kn">import</span> <span class="n">messaging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Basilisk.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">spacecraft</span><span class="p">,</span> <span class="n">extForceTorque</span><span class="p">,</span> <span class="n">msmForceTorque</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Basilisk.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">SimulationBaseClass</span><span class="p">,</span> <span class="n">macros</span><span class="p">,</span>
                                <span class="n">orbitalMotion</span><span class="p">,</span> <span class="n">simIncludeGravBody</span><span class="p">,</span>
                                <span class="n">unitTestSupport</span><span class="p">,</span> <span class="n">RigidBodyKinematics</span><span class="p">,</span> <span class="n">vizSupport</span><span class="p">,</span> <span class="n">SpherePlot</span><span class="p">)</span>

<span class="c1"># The path to the location of Basilisk</span>
<span class="c1"># Used to get the location of supporting data.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Basilisk</span><span class="w"> </span><span class="kn">import</span> <span class="n">__path__</span>

<span class="n">bskPath</span> <span class="o">=</span> <span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>


<div class="viewcode-block" id="run">
<a class="viewcode-back" href="../examples/scenarioTwoChargedSC.html#scenarioTwoChargedSC.run">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">show_plots</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The scenarios can be run with the following setup parameters:</span>

<span class="sd">    Args:</span>
<span class="sd">        show_plots (bool): Determines if the script should display plots</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create simulation variable names</span>
    <span class="n">dynTaskName</span> <span class="o">=</span> <span class="s2">&quot;dynTask&quot;</span>
    <span class="n">dynProcessName</span> <span class="o">=</span> <span class="s2">&quot;dynProcess&quot;</span>

    <span class="c1"># Create a sim module as an empty container</span>
    <span class="n">scSim</span> <span class="o">=</span> <span class="n">SimulationBaseClass</span><span class="o">.</span><span class="n">SimBaseClass</span><span class="p">()</span>

    <span class="c1">#</span>
    <span class="c1"># create the simulation process</span>
    <span class="c1">#</span>
    <span class="n">dynProcess</span> <span class="o">=</span> <span class="n">scSim</span><span class="o">.</span><span class="n">CreateNewProcess</span><span class="p">(</span><span class="n">dynProcessName</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># create the dynamics task and specify the integration update time</span>
    <span class="n">simulationTimeStep</span> <span class="o">=</span> <span class="n">macros</span><span class="o">.</span><span class="n">sec2nano</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
    <span class="n">dynProcess</span><span class="o">.</span><span class="n">addTask</span><span class="p">(</span><span class="n">scSim</span><span class="o">.</span><span class="n">CreateNewTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">simulationTimeStep</span><span class="p">))</span>

    <span class="c1">#</span>
    <span class="c1"># setup the simulation tasks/objects</span>
    <span class="c1">#</span>

    <span class="c1"># initialize leader spacecraft object and set properties</span>
    <span class="n">scObjectLeader</span> <span class="o">=</span> <span class="n">spacecraft</span><span class="o">.</span><span class="n">Spacecraft</span><span class="p">()</span>
    <span class="n">scObjectLeader</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;Leader&quot;</span>

    <span class="c1"># initialize follower spacecraft object and set properties</span>
    <span class="n">scObjectFollower</span> <span class="o">=</span> <span class="n">spacecraft</span><span class="o">.</span><span class="n">Spacecraft</span><span class="p">()</span>
    <span class="n">scObjectFollower</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;Follower&quot;</span>

    <span class="c1"># add spacecraftPlus object to the simulation process</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">scObjectLeader</span><span class="p">)</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">scObjectFollower</span><span class="p">)</span>

    <span class="c1"># clear prior gravitational body and SPICE setup definitions</span>
    <span class="n">gravFactory</span> <span class="o">=</span> <span class="n">simIncludeGravBody</span><span class="o">.</span><span class="n">gravBodyFactory</span><span class="p">()</span>

    <span class="c1"># setup Earth Gravity Body</span>
    <span class="n">earth</span> <span class="o">=</span> <span class="n">gravFactory</span><span class="o">.</span><span class="n">createEarth</span><span class="p">()</span>
    <span class="n">earth</span><span class="o">.</span><span class="n">isCentralBody</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># ensure this is the central gravitational body</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">earth</span><span class="o">.</span><span class="n">mu</span>

    <span class="c1"># attach gravity model to spaceCraftPlus</span>
    <span class="n">gravFactory</span><span class="o">.</span><span class="n">addBodiesTo</span><span class="p">(</span><span class="n">scObjectLeader</span><span class="p">)</span>
    <span class="n">gravFactory</span><span class="o">.</span><span class="n">addBodiesTo</span><span class="p">(</span><span class="n">scObjectFollower</span><span class="p">)</span>

    <span class="c1"># setup MSM module</span>
    <span class="n">MSMmodule</span> <span class="o">=</span> <span class="n">msmForceTorque</span><span class="o">.</span><span class="n">MsmForceTorque</span><span class="p">()</span>
    <span class="n">MSMmodule</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;msmForceTorqueTag&quot;</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">MSMmodule</span><span class="p">)</span>

    <span class="c1"># define electric potentials</span>
    <span class="n">voltLeaderInMsgData</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">VoltMsgPayload</span><span class="p">(</span><span class="n">voltage</span><span class="o">=-</span><span class="mi">500</span><span class="p">)</span> <span class="c1"># [V] servicer potential</span>
    <span class="n">voltLeaderInMsg</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">VoltMsg</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">voltLeaderInMsgData</span><span class="p">)</span>

    <span class="n">voltFollowerInMsgData</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">VoltMsgPayload</span><span class="p">(</span><span class="n">voltage</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span> <span class="c1"># [V] debris potential</span>
    <span class="n">voltFollowerInMsg</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">VoltMsg</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">voltFollowerInMsgData</span><span class="p">)</span>

    <span class="c1"># Import multi-sphere model of GOESR bus and read them into an array of strings</span>
    <span class="c1"># For each list of 4, the first 3 values are the spacial location of an individual sphere relative to a center of</span>
    <span class="c1"># [0,0,0] and the forth value is the radius of the sphere</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
    <span class="n">dataFileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;dataForExamples&#39;</span><span class="p">,</span> <span class="s1">&#39;GOESR_bus_80_sphs.csv&#39;</span><span class="p">)</span>
    <span class="n">scSphMod</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataFileName</span><span class="p">)</span>
    <span class="nb">type</span><span class="p">(</span><span class="n">scSphMod</span><span class="p">)</span>
    <span class="n">csvreader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">scSphMod</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csvreader</span><span class="p">:</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">scSphMod</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1"># Convert the strings to numbers and separate the location data from the radius data</span>
    <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spherelocation</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="n">rownum</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
        <span class="n">spherelocation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rownum</span><span class="p">)</span>
    <span class="n">spPosListLeader_H</span> <span class="o">=</span> <span class="n">spherelocation</span>  <span class="c1"># The location of each sphere for the leader spacecraft</span>
    <span class="n">rListLeader</span> <span class="o">=</span> <span class="n">radii</span>  <span class="c1"># radius of each sphere in the leader spacecraft</span>
    <span class="n">spPosListFollower_H</span> <span class="o">=</span> <span class="n">spherelocation</span>  <span class="c1"># The location of each sphere for the follower spacecraft</span>
    <span class="n">rListFollower</span> <span class="o">=</span> <span class="n">radii</span>  <span class="c1"># radius of each sphere in the follower spacecraft</span>


<span class="c1">#    If you would like to simulate each spacecraft by a single sphere, uncomment this section (line186 - line189) of</span>
    <span class="c1">#    code and comment out the previous section lines (162-181)</span>
<span class="c1">#     create a list of sphere body-fixed locations and associated radii using one sphere for each spacecraft</span>
<span class="c1">#    spPosListLeader_H = [[0,0,0]]  # one sphere located at origin of body frame</span>
<span class="c1">#    rListLeader = [2]  # radius of sphere is 2m</span>
<span class="c1">#    spPosListFollower_H = [[0,0,0]]  # one sphere located at origin of body frame</span>
<span class="c1">#    rListFollower = [2]  # radius of sphere is 2m</span>

    <span class="c1"># add spacecraft to state</span>
    <span class="n">MSMmodule</span><span class="o">.</span><span class="n">addSpacecraftToModel</span><span class="p">(</span><span class="n">scObjectLeader</span><span class="o">.</span><span class="n">scStateOutMsg</span><span class="p">,</span> <span class="n">messaging</span><span class="o">.</span><span class="n">DoubleVector</span><span class="p">(</span><span class="n">rListLeader</span><span class="p">),</span>
                                   <span class="n">unitTestSupport</span><span class="o">.</span><span class="n">npList2EigenXdVector</span><span class="p">(</span><span class="n">spPosListLeader_H</span><span class="p">))</span>
    <span class="n">MSMmodule</span><span class="o">.</span><span class="n">addSpacecraftToModel</span><span class="p">(</span><span class="n">scObjectFollower</span><span class="o">.</span><span class="n">scStateOutMsg</span><span class="p">,</span> <span class="n">messaging</span><span class="o">.</span><span class="n">DoubleVector</span><span class="p">(</span><span class="n">rListFollower</span><span class="p">),</span>
                                   <span class="n">unitTestSupport</span><span class="o">.</span><span class="n">npList2EigenXdVector</span><span class="p">(</span><span class="n">spPosListFollower_H</span><span class="p">))</span>

    <span class="c1"># subscribe input messages to module</span>
    <span class="n">MSMmodule</span><span class="o">.</span><span class="n">voltInMsgs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">voltLeaderInMsg</span><span class="p">)</span>
    <span class="n">MSMmodule</span><span class="o">.</span><span class="n">voltInMsgs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">voltFollowerInMsg</span><span class="p">)</span>

    <span class="c1"># setup extForceTorque module for Leader</span>
    <span class="c1"># the electrostatic force from the MSM module is read in through the messaging system</span>
    <span class="n">extFTObjectLeader</span> <span class="o">=</span> <span class="n">extForceTorque</span><span class="o">.</span><span class="n">ExtForceTorque</span><span class="p">()</span>
    <span class="n">extFTObjectLeader</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;eForceLeader&quot;</span>
    <span class="n">extFTObjectLeader</span><span class="o">.</span><span class="n">cmdForceInertialInMsg</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">MSMmodule</span><span class="o">.</span><span class="n">eForceOutMsgs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">scObjectLeader</span><span class="o">.</span><span class="n">addDynamicEffector</span><span class="p">(</span><span class="n">extFTObjectLeader</span><span class="p">)</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">extFTObjectLeader</span><span class="p">)</span>

    <span class="c1"># setup extForceTorque module for Follower</span>
    <span class="c1"># the electrostatic force from the MSM module is read in through the messaging system</span>
    <span class="n">extFTObjectFollower</span> <span class="o">=</span> <span class="n">extForceTorque</span><span class="o">.</span><span class="n">ExtForceTorque</span><span class="p">()</span>
    <span class="n">extFTObjectFollower</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;eForceDebris&quot;</span>
    <span class="n">extFTObjectFollower</span><span class="o">.</span><span class="n">cmdForceInertialInMsg</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">MSMmodule</span><span class="o">.</span><span class="n">eForceOutMsgs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">scObjectFollower</span><span class="o">.</span><span class="n">addDynamicEffector</span><span class="p">(</span><span class="n">extFTObjectFollower</span><span class="p">)</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">extFTObjectFollower</span><span class="p">)</span>

    <span class="c1">#   set initial Spacecraft States</span>
    <span class="c1">#</span>
    <span class="c1"># set up the Leader orbit using classical orbit elements</span>
    <span class="n">oe</span> <span class="o">=</span> <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">ClassicElements</span><span class="p">()</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">42164</span> <span class="o">*</span> <span class="mf">1e3</span>  <span class="c1"># [m] Geosynchronous Orbit</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">Omega</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">oe</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">r_LN</span><span class="p">,</span> <span class="n">v_LN</span> <span class="o">=</span> <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">elem2rv</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">oe</span><span class="p">)</span>
    <span class="n">scObjectLeader</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">r_CN_NInit</span> <span class="o">=</span> <span class="n">r_LN</span>  <span class="c1"># m</span>
    <span class="n">scObjectLeader</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">v_CN_NInit</span> <span class="o">=</span> <span class="n">v_LN</span>  <span class="c1"># m/s</span>
    <span class="n">oe</span> <span class="o">=</span> <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">rv2elem</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">r_LN</span><span class="p">,</span> <span class="n">v_LN</span><span class="p">)</span>

    <span class="c1"># setup Follower object states</span>
    <span class="n">r_FS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># relative position of follower, 10m behind servicer in along-track direction</span>
    <span class="n">r_FN</span> <span class="o">=</span> <span class="n">r_FS</span> <span class="o">+</span> <span class="n">r_LN</span>
    <span class="n">v_FN</span> <span class="o">=</span> <span class="n">v_LN</span>
    <span class="n">scObjectFollower</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">r_CN_NInit</span> <span class="o">=</span> <span class="n">r_FN</span>  <span class="c1"># m</span>
    <span class="n">scObjectFollower</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">v_CN_NInit</span> <span class="o">=</span> <span class="n">v_FN</span>  <span class="c1"># m/s</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">oe</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="n">oe</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="n">oe</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">n</span>  <span class="c1"># orbit period</span>

    <span class="c1">#</span>
    <span class="c1">#   Setup data logging before the simulation is initialized</span>
    <span class="c1">#</span>
    <span class="n">numDataPoints</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">simulationTime</span> <span class="o">=</span> <span class="n">macros</span><span class="o">.</span><span class="n">sec2nano</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">P</span><span class="p">)</span>
    <span class="n">samplingTime</span> <span class="o">=</span> <span class="n">simulationTime</span> <span class="o">//</span> <span class="p">(</span><span class="n">numDataPoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dataRecL</span> <span class="o">=</span> <span class="n">scObjectLeader</span><span class="o">.</span><span class="n">scStateOutMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">()</span>
    <span class="n">dataRecF</span> <span class="o">=</span> <span class="n">scObjectFollower</span><span class="o">.</span><span class="n">scStateOutMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">()</span>

    <span class="c1"># Add recorders to the Task</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">dataRecL</span><span class="p">)</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">dynTaskName</span><span class="p">,</span> <span class="n">dataRecF</span><span class="p">)</span>

    <span class="c1"># if this scenario is to interface with the BSK Viz, uncomment the following lines</span>
    <span class="c1"># to save the BSK data to a file, uncomment the saveFile line below</span>
    <span class="k">if</span> <span class="n">vizSupport</span><span class="o">.</span><span class="n">vizFound</span><span class="p">:</span>
        <span class="n">viz</span> <span class="o">=</span> <span class="n">vizSupport</span><span class="o">.</span><span class="n">enableUnityVisualization</span><span class="p">(</span><span class="n">scSim</span><span class="p">,</span> <span class="n">dynTaskName</span><span class="p">,</span> <span class="p">[</span><span class="n">scObjectLeader</span><span class="p">,</span> <span class="n">scObjectFollower</span><span class="p">]</span>
                                                  <span class="c1"># , saveFile=fileName,</span>
                                                  <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1">#   initialize Simulation</span>
    <span class="c1">#</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">InitializeSimulation</span><span class="p">()</span>

    <span class="c1">#</span>
    <span class="c1">#   configure a simulation stop time and execute the simulation run</span>
    <span class="c1">#</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">ConfigureStopTime</span><span class="p">(</span><span class="n">simulationTime</span><span class="p">)</span>
    <span class="n">scSim</span><span class="o">.</span><span class="n">ExecuteSimulation</span><span class="p">()</span>

    <span class="c1"># Retrieve the charge data of the spheres</span>
    <span class="n">LeaderSpCharges</span> <span class="o">=</span> <span class="n">unitTestSupport</span><span class="o">.</span><span class="n">columnToRowList</span><span class="p">(</span><span class="n">MSMmodule</span><span class="o">.</span><span class="n">chargeMsmOutMsgs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
    <span class="n">FollowerSpCharges</span> <span class="o">=</span> <span class="n">unitTestSupport</span><span class="o">.</span><span class="n">columnToRowList</span><span class="p">(</span><span class="n">MSMmodule</span><span class="o">.</span><span class="n">chargeMsmOutMsgs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>

    <span class="c1"># retrieve the logged data from the recorders</span>
    <span class="n">posDataL_N</span> <span class="o">=</span> <span class="n">dataRecL</span><span class="o">.</span><span class="n">r_BN_N</span>
    <span class="n">velDataL_N</span> <span class="o">=</span> <span class="n">dataRecL</span><span class="o">.</span><span class="n">v_BN_N</span>
    <span class="n">posDataF_N</span> <span class="o">=</span> <span class="n">dataRecF</span><span class="o">.</span><span class="n">r_BN_N</span>

    <span class="n">attDataL_N</span> <span class="o">=</span> <span class="n">dataRecL</span><span class="o">.</span><span class="n">sigma_BN</span>
    <span class="n">attDataF_N</span> <span class="o">=</span> <span class="n">dataRecF</span><span class="o">.</span><span class="n">sigma_BN</span>

    <span class="c1"># Calculate relative position vector and magnitude in the inertial frame</span>
    <span class="n">relPosData_N</span> <span class="o">=</span> <span class="n">posDataL_N</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">posDataF_N</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">relPosMagn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relPosData_N</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Project the relative position data from the inertial frame into the Hill frame of the leader spacecraft</span>
    <span class="n">relPosData_H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">relXPosData_H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">relYPosData_H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">relZPosData_H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relPosData_N</span><span class="p">)):</span>
        <span class="c1"># Calculate the discrete cosine matrix for mapping from inertial frame to the Hill frame of the leader spacecraft</span>
        <span class="n">nrn</span> <span class="o">=</span> <span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">nrh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">velDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">posDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>
                                                                                       <span class="n">velDataL_N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">nre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">nrh</span><span class="p">,</span> <span class="n">nrn</span><span class="p">)</span>
        <span class="n">HN</span> <span class="o">=</span> <span class="n">nrn</span><span class="p">,</span> <span class="n">nre</span><span class="p">,</span> <span class="n">nrh</span>

        <span class="c1"># Map the relative postion data to the Hill frame of the leader spacecraft</span>
        <span class="n">relPosDatai_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">HN</span><span class="p">,</span> <span class="n">relPosData_N</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">relXPosData_H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relPosDatai_H</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">relYPosData_H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relPosDatai_H</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">relZPosData_H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relPosDatai_H</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">relPosData_H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relPosDatai_H</span><span class="p">)</span>

    <span class="c1"># Collect times of each recording</span>
    <span class="n">timeData</span> <span class="o">=</span> <span class="n">dataRecL</span><span class="o">.</span><span class="n">times</span><span class="p">()</span>

    <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">figureList</span> <span class="o">=</span> <span class="n">plotOrbits</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">posDataL_N</span><span class="p">,</span> <span class="n">posDataF_N</span><span class="p">,</span> <span class="n">relPosMagn</span><span class="p">,</span> <span class="n">attDataL_N</span><span class="p">,</span> <span class="n">attDataF_N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spPosListLeader_H</span><span class="p">,</span>
                            <span class="n">rListLeader</span><span class="p">,</span> <span class="n">LeaderSpCharges</span><span class="p">,</span> <span class="n">spPosListFollower_H</span><span class="p">,</span> <span class="n">rListFollower</span><span class="p">,</span> <span class="n">FollowerSpCharges</span><span class="p">,</span>
                            <span class="n">relXPosData_H</span><span class="p">,</span> <span class="n">relYPosData_H</span><span class="p">,</span> <span class="n">relZPosData_H</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_plots</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># close the plots being saved off to avoid over-writing old and new figures</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">figureList</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">plotOrbits</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">posDataL_N</span><span class="p">,</span> <span class="n">posDataF_N</span><span class="p">,</span> <span class="n">relPosMagn</span><span class="p">,</span> <span class="n">attDataL_N</span><span class="p">,</span> <span class="n">attDataF_N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">spPosListLeader_H</span><span class="p">,</span> <span class="n">rListLeader</span><span class="p">,</span>
               <span class="n">LeaderSpCharges</span><span class="p">,</span> <span class="n">spPosListFollower_H</span><span class="p">,</span> <span class="n">rListFollower</span><span class="p">,</span> <span class="n">FollowerSpCharges</span><span class="p">,</span> <span class="n">relXPosData_H</span><span class="p">,</span> <span class="n">relYPosData_H</span><span class="p">,</span>
               <span class="n">relZPosData_H</span><span class="p">):</span>

    <span class="c1">#</span>
    <span class="c1"># draw the total separation of the spacecrafts</span>
    <span class="c1">#</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>  <span class="c1"># clears out plots from earlier test runs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeData</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">NANO2SEC</span> <span class="o">/</span> <span class="n">P</span><span class="p">,</span> <span class="n">relPosMagn</span><span class="p">[:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [orbits]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Separation [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total separation&#39;</span><span class="p">)</span>
    <span class="n">figureList</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pltName</span> <span class="o">=</span> <span class="s1">&#39;scenarioTwoChargedSC1&#39;</span>
    <span class="n">figureList</span><span class="p">[</span><span class="n">pltName</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Plot relative separation in the Frame of the Leader spacecrafts</span>
    <span class="c1">#</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Set the Leader S/C as the center of the plot</span>
    <span class="n">r_LN_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="c1"># get sphere locations</span>
    <span class="n">dcm_NL</span> <span class="o">=</span> <span class="n">RigidBodyKinematics</span><span class="o">.</span><span class="n">MRP2C</span><span class="p">(</span><span class="n">attDataF_N</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">spPosL_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dcm_NL</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spPosListLeader_H</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">radiiL</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rListLeader</span><span class="p">)</span>
    <span class="c1"># Plot the sphere locations to model the Leader spacecraft</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">radiiL</span><span class="p">)):</span>
        <span class="n">r_SpN_N</span> <span class="o">=</span> <span class="n">r_LN_N</span> <span class="o">+</span> <span class="n">spPosL_N</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">r_SpN_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">radiiL</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">r_SpN_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">radiiL</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">r_SpN_N</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">radiiL</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>

    <span class="c1"># Plot the relative position of the Follower spacecraft</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">relXPosData_H</span><span class="p">,</span> <span class="n">relYPosData_H</span><span class="p">,</span> <span class="n">relZPosData_H</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radial(m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Along Track(m)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Orbit Normal (m)&#39;</span><span class="p">)</span>
    <span class="n">pltName</span> <span class="o">=</span> <span class="s1">&#39;scenarioTwoChargedSC2&#39;</span>
    <span class="n">figureList</span><span class="p">[</span><span class="n">pltName</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Draw the sphere representation of the satellites used by the MSM in the Hill frame of the Leader spacecraft</span>
    <span class="c1">#</span>
    <span class="n">SpherePlotList</span> <span class="o">=</span> <span class="n">SpherePlot</span><span class="o">.</span><span class="n">plotSpheres</span><span class="p">(</span><span class="n">posDataL_N</span><span class="p">,</span> <span class="n">posDataF_N</span><span class="p">,</span> <span class="n">attDataL_N</span><span class="p">,</span> <span class="n">attDataF_N</span><span class="p">,</span> <span class="n">spPosListLeader_H</span><span class="p">,</span> <span class="n">rListLeader</span><span class="p">,</span>
               <span class="n">LeaderSpCharges</span><span class="p">,</span> <span class="n">spPosListFollower_H</span><span class="p">,</span> <span class="n">rListFollower</span><span class="p">,</span> <span class="n">FollowerSpCharges</span><span class="p">)</span>

    <span class="n">figureList</span><span class="p">[</span><span class="s1">&#39;scenarioTwoChargedSC3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpherePlotList</span><span class="p">[</span><span class="s1">&#39;Charged_Spheres&#39;</span><span class="p">]</span>
    <span class="n">figureList</span><span class="p">[</span><span class="s1">&#39;scenarioTwoChargedSC4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpherePlotList</span><span class="p">[</span><span class="s1">&#39;Colorbar&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">figureList</span>


<span class="k">def</span><span class="w"> </span><span class="nf">NormalizeData</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># This statement below ensures that the unit test scrip can be run as a</span>
<span class="c1"># stand-along python script</span>
<span class="c1">#</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span>  <span class="c1"># show_plots</span>
    <span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Autonomous Vehicle Systems (AVS) Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>