

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module Definition File &mdash; Basilisk 2.8.3
 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=57a44e8a" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5e07a493"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=3cd7d658"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Swig Interface File" href="cModules-4.html" />
    <link rel="prev" title="C Message Object" href="cModules-2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CFB87C" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Basilisk
              <img src="../../../_static/Basilisk-Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basilisk:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Install.html">Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../Learn.html">Learning Basilisk</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../bskPrinciples.html">Fundamentals of Basilisk Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/index.html">Integrated Example Scripts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../makingModules.html">Basics of Writing Basilisk Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../makingModules-1.html">Module Design Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../makingModules-2.html">Creating New Message Definitions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../cModules.html">Making C Modules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cModules-1.html">Module Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="cModules-2.html">C Message Object</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Module Definition File</a></li>
<li class="toctree-l4"><a class="reference internal" href="cModules-4.html">Swig Interface File</a></li>
<li class="toctree-l4"><a class="reference internal" href="cModules-5.html">Deprecated SWIG Interface File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cppModules.html">Making C++ Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pyModules.html">Making Python Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../makingModules-3.html">Module RST Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../makingModules-4.html">Module Unit Test File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../makingDraftModule.html">Automation Script to Create a New Basilisk Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../makingModules-5.html">Common Basilisk Support Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advancedTopics.html">Advanced Topics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../supportData.html">Support Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ExternalSites.html">External Sites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vizard:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/Vizard.html">About Vizard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/VizardDownload.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/VizardReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/VizardGUI.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/vizardAdvanced/index.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vizard/vizardGallery.html">Video Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #CFB87C" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Basilisk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../Learn.html">Learning Basilisk</a></li>
          <li class="breadcrumb-item"><a href="../../makingModules.html">Basics of Writing Basilisk Modules</a></li>
          <li class="breadcrumb-item"><a href="../cModules.html">Making C Modules</a></li>
      <li class="breadcrumb-item active">Module Definition File</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/Learn/makingModules/cModules/cModules-3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-definition-file">
<span id="cmodules-3"></span><h1>Module Definition File<a class="headerlink" href="#module-definition-file" title="Link to this heading"></a></h1>
<p>The module function is defined in the <code class="docutils literal notranslate"><span class="pre">SomeModule.c</span></code> file.  This page outlines key expected behaviors.</p>
<section id="selfinit-method">
<h2>SelfInit Method<a class="headerlink" href="#selfinit-method" title="Link to this heading"></a></h2>
<p>A C code does not have constructors.  Thus, the Basilisk C module must define a self initialization function to ensure the output messages are setup to write to themselves.  This is shown in the sample code below.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/*!</span>
<span class="cm">    This method initializes the output messages for this module.</span>
<span class="cm"> @return void</span>
<span class="cm"> @param configData The configuration data associated with this module</span>
<span class="cm"> @param moduleID The module identifier</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">SelfInit_someModule</span><span class="p">(</span><span class="n">someModuleConfig</span><span class="w"> </span><span class="o">*</span><span class="n">configData</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">moduleID</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">SomeMsg_C_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">someOutMsg</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SelfInit</span></code> function should only do the above steps.  Don’t try to set default module variables here as the <code class="docutils literal notranslate"><span class="pre">configData</span></code> structure is zero’d in Swig when this structure copy is created in Python.  Thus, for C modules all default config structure variables are zero!</p>
</div>
</section>
<section id="reset-method">
<h2>Reset Method<a class="headerlink" href="#reset-method" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Reset_....()</span></code> method should be used to</p>
<ul class="simple">
<li><p>restore module variables if needed. For example, the integral feedback gain variable might be reset to 0.</p></li>
<li><p>perform one-time message reads such as reading in the reaction wheel or spacecraft configuration message etc.  Whenever <code class="docutils literal notranslate"><span class="pre">Reset()</span></code> is called the module should read in these messages again to use the latest values.</p></li>
<li><p>check that required input messages are connected.  If a required input message is not connected when <code class="docutils literal notranslate"><span class="pre">Reset()</span></code> is called, then log a BSK error message.</p></li>
</ul>
<p>The following sample code assumes that the class variable <code class="docutils literal notranslate"><span class="pre">value</span></code> should be re-set to 0 on <code class="docutils literal notranslate"><span class="pre">Reset()</span></code>, and that <code class="docutils literal notranslate"><span class="pre">someInMsg</span></code> is a required input message:L</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/*! This method performs a complete reset of the module.  Local module variables that retain</span>
<span class="cm"> time varying states between function calls are reset to their default values.</span>
<span class="cm"> @return void</span>
<span class="cm"> @param configData The configuration data associated with the module</span>
<span class="cm"> @param callTime [ns] time the method is called</span>
<span class="cm"> @param moduleID The module identifier</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Reset_someModule</span><span class="p">(</span><span class="n">someModuleConfig</span><span class="w"> </span><span class="o">*</span><span class="n">configData</span><span class="p">,</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">callTime</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">moduleID</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">SomeMsg_C_isLinked</span><span class="p">(</span><span class="o">&amp;</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">someInMsg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">info</span><span class="p">[</span><span class="n">MAX_LOGGING_LENGTH</span><span class="p">];</span>
<span class="w">        </span><span class="n">sprintf</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SomeModule does not have someInMsg connected!);</span>
<span class="w">        </span><span class="n">_bskLog</span><span class="p">(</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">bskLogger</span><span class="p">,</span><span class="w"> </span><span class="n">BSK_ERROR</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that doing a Basilisk log in a C module is different and than within a C++ module.</p>
</section>
<section id="update-method">
<h2>Update Method<a class="headerlink" href="#update-method" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Update_....()</span></code> function is called each time the Basilisk simulation runs the C module.  This method needs to perform all the required BSK module function, including reading in input messages and writing to output messages.  In the sample code below the message reading and writing, as well as the module function is done directly within this function.  Some modules also create additional functions to separate out the various functions.  This is left up to the module developer as a code design choice.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/*! Add a description of what this main Update() routine does for this module</span>
<span class="cm"> @return void</span>
<span class="cm"> @param configData The configuration data associated with the module</span>
<span class="cm"> @param callTime The clock time at which the function was called (nanoseconds)</span>
<span class="cm"> @param moduleID The module identifier</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Update_someModule</span><span class="p">(</span><span class="n">someModuleConfig</span><span class="w"> </span><span class="o">*</span><span class="n">configData</span><span class="p">,</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">callTime</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">moduleID</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">SomeMsgPayload</span><span class="w"> </span><span class="n">outMsgBuffer</span><span class="p">;</span><span class="w">       </span><span class="cm">/*!&lt; local output message copy */</span>
<span class="w">    </span><span class="n">SomeMsgPayload</span><span class="w"> </span><span class="n">inMsgBuffer</span><span class="p">;</span><span class="w">        </span><span class="cm">/*!&lt; local copy of input message */</span>

<span class="w">    </span><span class="c1">// always zero the output buffer first</span>
<span class="w">    </span><span class="n">outMsgBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SomeMsg_C_zeroMsgPayload</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/*! - Read the input messages */</span>
<span class="w">    </span><span class="n">inMsgBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SomeMsg_C_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">someInMsg</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* As an example of a module function, here we simply copy input message content to output message. */</span>
<span class="w">    </span><span class="n">v3Copy</span><span class="p">(</span><span class="n">inMsgBuffer</span><span class="p">.</span><span class="n">dataVector</span><span class="p">,</span><span class="w"> </span><span class="n">outMsgBuffer</span><span class="p">.</span><span class="n">dataVector</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/*! - write the module output message */</span>
<span class="w">    </span><span class="n">SomeMsg_C_write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">outMsgBuffer</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">someOutMsg</span><span class="p">,</span><span class="w"> </span><span class="n">moduleID</span><span class="p">,</span><span class="w"> </span><span class="n">callTime</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is critical that each module zeros the content of the output messages on each update cycle.  This way we are not writing stale or uninitialized data to a message.  When reading a message BSK assumes that each message content has been either zero’d or written to.</p>
</div>
</section>
<section id="array-of-messages">
<h2>Array of Messages<a class="headerlink" href="#array-of-messages" title="Link to this heading"></a></h2>
<p>Assume the module has an array called <code class="docutils literal notranslate"><span class="pre">moreInMsgs</span></code> which contain input message objects of type <code class="docutils literal notranslate"><span class="pre">SomeMsg_C</span></code>.  Interfacing with these messages is done in a standard C manner with how elements of an array are retrieved.  For example, to read the 3-slot of the input array the code could read as</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">inMsgBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SomeMsg_C_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">configData</span><span class="o">-&gt;</span><span class="n">moreInMsgs</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cModules-2.html" class="btn btn-neutral float-left" title="C Message Object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cModules-4.html" class="btn btn-neutral float-right" title="Swig Interface File" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Autonomous Vehicle Systems (AVS) Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>