(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27757,        758]
NotebookOptionsPosition[     22695,        659]
NotebookOutlinePosition[     23049,        675]
CellTagsIndexPosition[     23006,        672]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Magnetic Field Models", "Title",
 CellChangeTimes->{{3.7611602395386744`*^9, 
  3.761160242506854*^9}},ExpressionUUID->"b3741299-3e65-425c-9750-\
98a2f5725af8"],

Cell[CellGroupData[{

Cell["Simple Dipole Models", "Section",
 CellChangeTimes->{{3.7611602460144176`*^9, 
  3.7611602512741127`*^9}},ExpressionUUID->"dde990d1-6cd6-4ed8-bd65-\
f522b6c03d22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"req", " ", "=", " ", 
   RowBox[{"6371.2", "*", "1000"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.761171685497162*^9, 3.761171704817787*^9}, {
  3.761222714141919*^9, 3.7612227190511703`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"e3612ac8-4b7c-4257-bec1-d40f655621b2"],

Cell[CellGroupData[{

Cell["Spacecraft Design", "Subsection",
 CellChangeTimes->{{3.761161263796702*^9, 
  3.761161267289089*^9}},ExpressionUUID->"24867fba-8e3d-40df-863f-\
ea8de3e0c6f3"],

Cell["\<\
This field assumes a north geomagnetic pole of 78.5\:02da N and 69.7\:02daW\
\>", "Text",
 CellChangeTimes->{{3.761161216773966*^9, 
  3.761161240043467*^9}},ExpressionUUID->"94accf41-55f4-4829-83e7-\
9ecfd8816b6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"magFieldGrifin", "[", "rVec_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rMag", ",", "\[Lambda]", ",", "\[Phi]", ",", "BfieldNED"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rMag", " ", "=", " ", 
      RowBox[{"Norm", "[", "rVec", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rVec", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"rVec", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", "0"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"rVec", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"rVec", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       ",", " ", 
       RowBox[{"\[Lambda]", " ", "=", " ", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Phi]", " ", "=", " ", 
      RowBox[{"ArcSin", "[", 
       RowBox[{
        RowBox[{"rVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "rMag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"BfieldNED", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"req", "/", "rMag"}], ")"}], "^", "3."}]}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]", "]"}], 
             RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]", "]"}], 
             RowBox[{"Sin", "[", "\[Lambda]", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Sin", "[", "\[Lambda]", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Lambda]", "]"}]}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Phi]", "]"}], 
              RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], " ", ",", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Phi]", "]"}], 
              RowBox[{"Sin", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], "}"}], 
        " ", ".", 
        RowBox[{"{", 
         RowBox[{"29000", ",", "1900", ",", 
          RowBox[{"-", "5530"}]}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "BfieldNED", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.761160791841695*^9, 3.761160808834175*^9}, {
   3.761160839591168*^9, 3.761160918446228*^9}, {3.761161011372511*^9, 
   3.761161129370013*^9}, {3.7611611824817123`*^9, 3.761161204966709*^9}, 
   3.761161309030128*^9, {3.761161351692739*^9, 3.761161357843279*^9}, {
   3.761161527079445*^9, 3.7611615555829906`*^9}, 3.761161596470673*^9, 
   3.761161691091264*^9, {3.761167300474043*^9, 3.761167305922627*^9}, 
   3.761171696011424*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"6878ffd4-baee-4dba-af5f-d5f1a57ad4db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"rVecE", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"5000.", ",", "5000", ",", "2500"}], "}"}], "1000"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.761161320039953*^9, 3.761161336281125*^9}, {
  3.76116145307368*^9, 3.76116147163428*^9}, {3.76122273763161*^9, 
  3.761222738195681*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"82ee7af1-ff7d-4fa6-9eda-c7b8fa079dde"],

Cell[BoxData["7.5`*^6"], "Output",
 CellChangeTimes->{{3.761161338233626*^9, 3.76116135930447*^9}, {
   3.761161454909383*^9, 3.761161472378436*^9}, 3.761161599569516*^9, 
   3.761161692801365*^9, 3.761170031763824*^9, 3.761222739752166*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"b70a4575-74cc-47ce-b7d6-2b6793485e15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]", " ", "=", " ", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"rVecE", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"rVecE", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7611701531834517`*^9, 3.761170154271412*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"a5cdc0a9-ea0b-4a27-8828-b6531d15c1ef"],

Cell[BoxData["0.7853981633974483`"], "Output",
 CellChangeTimes->{3.761170154877943*^9, 3.7611707692472754`*^9, 
  3.761222742071471*^9},
 CellLabel->
  "Out[213]=",ExpressionUUID->"ae15ec63-8a0d-42bc-924f-f82f2b55cd97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]", " ", "=", " ", 
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"rVecE", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/", 
    RowBox[{"Norm", "[", "rVecE", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.761170170514616*^9, 3.761170179119265*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"12eb5faa-31f8-422b-a7f5-bc8b3abe23cb"],

Cell[BoxData["0.3398369094541219`"], "Output",
 CellChangeTimes->{{3.761170175504636*^9, 3.761170179522511*^9}, 
   3.761170769989255*^9, 3.761222742838048*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"b142b309-917e-482a-b6ea-ac0724521052"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TE", "=", 
  RowBox[{
   RowBox[{"Euler2", "[", 
    RowBox[{
     RowBox[{"-", "90"}], " ", "Degree"}], "]"}], ".", 
   RowBox[{"Euler2", "[", 
    RowBox[{"-", "\[Phi]"}], "]"}], ".", 
   RowBox[{"Euler3", "[", "\[Lambda]", "]"}]}]}]], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"e0915515-3d9a-494d-84c9-83100a17d07d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.23570226039551584`"}], ",", 
     RowBox[{"-", "0.2357022603955158`"}], ",", "0.9428090415820634`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7071067811865475`"}], ",", "0.7071067811865476`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6666666666666667`"}], ",", 
     RowBox[{"-", "0.6666666666666666`"}], ",", 
     RowBox[{"-", "0.3333333333333333`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7612212089566717`*^9, 3.761222745377109*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"5b261804-dfb2-484b-82b2-c8c0c4dc41aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BT1", "=", 
  RowBox[{"magFieldGrifin", "[", "rVecE", "]"}]}]], "Input",
 CellChangeTimes->{{3.761161339911333*^9, 3.761161343292625*^9}, {
  3.761221140240713*^9, 3.761221144456441*^9}, {3.7612212184765472`*^9, 
  3.761221218657753*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"a59826de-fc49-44d6-ab96-ce59de9b2e96"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"17285.57278076451`", ",", 
   RowBox[{"-", "3220.725714981534`"}], ",", "8884.811240310806`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7611613437218857`*^9, 3.7611613599891567`*^9}, 
   3.7611616010414667`*^9, 3.761161693707308*^9, 3.761167317210127*^9, 
   3.761221145494506*^9, 3.761221220245243*^9, 3.76122275902842*^9},
 CellLabel->
  "Out[217]=",ExpressionUUID->"e9f7e22f-f7bd-4e21-902b-df1436e5d56d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BE1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Transpose", "[", "TE", "]"}], ".", "BT1"}]}]], "Input",
 CellChangeTimes->{{3.76122121308971*^9, 3.761221234574098*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"31093fc9-15dd-4b86-8d46-502acb8cd725"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7720.0590767926005`"}], ",", 
   RowBox[{"-", "12274.85306360327`"}], ",", "13335.390559859321`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7612212353785257`*^9, 3.7612227650866327`*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"921544ce-ba09-41d6-9741-f129bb0b9044"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rVecEnorth", " ", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "7000"}], "}"}], "1000"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.761170962459869*^9, 3.7611709741036797`*^9}, {
  3.761222802129977*^9, 3.7612228032667923`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"67375f38-cb6f-45e0-9d5a-2bdf105b8de6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BT2", "=", 
  RowBox[{"magFieldGrifin", "[", "rVecEnorth", "]"}]}]], "Input",
 CellChangeTimes->{{3.761161339911333*^9, 3.761161343292625*^9}, 
   3.7611614466741877`*^9, {3.761161477220595*^9, 3.76116148242339*^9}, 
   3.761170979635881*^9, {3.761223340256003*^9, 3.76122334148577*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"07fcd2a8-58d6-4596-b437-b114ab723d6e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1432.5942244438575`"}], ",", 
   RowBox[{"-", "4169.603190091859`"}], ",", "43731.82369354933`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.761161483823567*^9, 3.7611615587364597`*^9, 
  3.761161602297242*^9, 3.761161694471571*^9, 3.7611673091512814`*^9, 
  3.761170980305799*^9, 3.7612228047086697`*^9, 3.761223342014791*^9},
 CellLabel->
  "Out[238]=",ExpressionUUID->"9653e53a-98c5-486f-a10e-779e5bbfa2ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TE", "=", 
  RowBox[{
   RowBox[{"Euler2", "[", 
    RowBox[{
     RowBox[{"-", "90"}], " ", "Degree"}], "]"}], ".", 
   RowBox[{"Euler2", "[", 
    RowBox[{
     RowBox[{"-", "90."}], " ", "Degree"}], "]"}], ".", 
   RowBox[{"Euler3", "[", "0", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.761223328018552*^9, 3.761223333193447*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"c6b679f5-cee4-42bb-851d-9a40de1be838"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.`"}], ",", "0.`", ",", "6.123233995736766`*^-17"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.123233995736766`*^-17"}], ",", "0.`", ",", 
     RowBox[{"-", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.761223334088695*^9},
 CellLabel->
  "Out[237]=",ExpressionUUID->"0fffc7cd-558b-49b2-b65b-048af95e2c9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BE2", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", "TE", "]"}], ".", "BT2"}]}]], "Input",
 CellChangeTimes->{{3.761223344268951*^9, 3.761223364415888*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"fadc9278-7193-4c0b-b42c-87323b693e8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1432.5942244438547`", ",", 
   RowBox[{"-", "4169.603190091859`"}], ",", 
   RowBox[{"-", "43731.82369354933`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.761223365065268*^9},
 CellLabel->
  "Out[239]=",ExpressionUUID->"9124b1a6-78bf-4ec1-ab94-1be84afd3258"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["centered dipole", "Subsection",
 CellChangeTimes->{{3.761161280026561*^9, 3.7611612854660807`*^9}, {
  3.761162314126008*^9, 
  3.761162316453082*^9}},ExpressionUUID->"8f6aa3f4-1f72-4525-96ae-\
4c0ba2c6e956"],

Cell[BoxData[
 RowBox[{"<<", "RigidBodyKinematics`"}]], "Input",
 CellChangeTimes->{{3.76116028449362*^9, 3.761160289582904*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5e9a2f52-e785-444f-b9a1-2ce480cf6dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"centeredDipole", "[", "rVecE_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rMag", ",", "m", ",", "rHat", ",", "BE"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rMag", " ", "=", " ", 
      RowBox[{"Norm", "[", "rVecE", " ", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rHat", " ", "=", " ", 
      RowBox[{"rVecE", " ", "/", "rMag"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{
       RowBox[{"req", "^", "3"}], " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1900"}], ",", " ", "5530", ",", 
         RowBox[{"-", "29000"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"BE", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", " ", "rHat", ",", " ", "rHat"}], "]"}]}], 
          "-", " ", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ")"}], ".", "m"}], "/", 
       RowBox[{"rMag", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "BE", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.76116983137292*^9, 3.761170024538576*^9}, {
   3.7611700698615923`*^9, 3.761170071016591*^9}, 3.761170765715787*^9, {
   3.761171122072507*^9, 3.7611711969322557`*^9}, {3.761171320030284*^9, 
   3.761171352475054*^9}, {3.7611717012337933`*^9, 3.7611717021939373`*^9}, {
   3.761218335231361*^9, 3.761218344753099*^9}, {3.761218436512929*^9, 
   3.7612184391472597`*^9}, 3.761221499254425*^9, {3.7612215509824133`*^9, 
   3.761221595348377*^9}, {3.761222474734695*^9, 3.761222475321272*^9}, {
   3.761222623492916*^9, 3.761222626775672*^9}, {3.7612227750527687`*^9, 
   3.761222787927289*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"8ba81c4b-319a-4ca6-8478-32dd93a469ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BE", "=", 
  RowBox[{"centeredDipole", "[", "rVecE", "]"}]}]], "Input",
 CellChangeTimes->{{3.761170036539823*^9, 3.7611700392762823`*^9}, {
  3.761170224954677*^9, 3.761170226032494*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"64c7ef8a-3115-4700-8014-b69fe63b8f36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7720.059076792601`"}], ",", 
   RowBox[{"-", "12274.853063603268`"}], ",", "13335.390559859323`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7611700396903152`*^9, 3.7611700750677433`*^9, 3.7611702264696293`*^9, 
   3.76117077209907*^9, 3.761171182925062*^9, {3.7611713350845346`*^9, 
   3.761171357007045*^9}, 3.761218352802743*^9, 3.761218487281652*^9, 
   3.761221501677948*^9, 3.7612216014089813`*^9, 3.7612224794708147`*^9, 
   3.761222596095995*^9, 3.761222628713689*^9, {3.7612227799843683`*^9, 
   3.761222790893427*^9}},
 CellLabel->
  "Out[222]=",ExpressionUUID->"0d6a2877-d47a-414d-b09a-b90d4a5c5507"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BE", "=", 
  RowBox[{"centeredDipole", "[", "rVecEnorth", "]"}]}]], "Input",
 CellChangeTimes->{{3.761170036539823*^9, 3.7611700392762823`*^9}, {
  3.761170224954677*^9, 3.761170226032494*^9}, {3.761218494531393*^9, 
  3.7612185024320374`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"f50b92a1-7846-4430-ac31-0c53c26d145c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1432.594224443858`", ",", 
   RowBox[{"-", "4169.60319009186`"}], ",", 
   RowBox[{"-", "43731.82369354934`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.761218503806026*^9, 3.761222489022039*^9, 3.761222629831821*^9, {
   3.7612227928359413`*^9, 3.761222807601245*^9}},
 CellLabel->
  "Out[226]=",ExpressionUUID->"7d5d20cb-dc90-4465-8ca7-49ba25eb5274"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rVecE"], "Input",
 CellChangeTimes->{{3.761242325535123*^9, 3.761242327559642*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"c16762c2-d5c7-48c2-a496-baf8b29070b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.`*^6", ",", "5000000", ",", "2500000"}], "}"}]], "Output",
 CellChangeTimes->{3.761242327940855*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"eb8a2fca-957d-426c-b50d-6f81cb337cf0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.761242448595797*^9, 
  3.761242451028562*^9}},ExpressionUUID->"8af01b86-4351-4f0f-b5dc-\
3849b8cd0f6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"centeredDipole", "[", "rVecE_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rMag", ",", "m", ",", "rHat", ",", "BE"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rMag", " ", "=", " ", 
      RowBox[{"Norm", "[", "rVecE", " ", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rHat", " ", "=", " ", 
      RowBox[{"rVecE", " ", "/", "rMag"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{
       RowBox[{"req", "^", "3"}], " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2318"}], ",", " ", "5817", ",", 
         RowBox[{"-", "30926"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"BE", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", " ", "rHat", ",", " ", "rHat"}], "]"}]}], 
          "-", " ", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ")"}], ".", "m"}], "/", 
       RowBox[{"rMag", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "BE", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.76116983137292*^9, 3.761170024538576*^9}, {
   3.7611700698615923`*^9, 3.761170071016591*^9}, 3.761170765715787*^9, {
   3.761171122072507*^9, 3.7611711969322557`*^9}, {3.761171320030284*^9, 
   3.761171352475054*^9}, {3.7611717012337933`*^9, 3.7611717021939373`*^9}, {
   3.761218335231361*^9, 3.761218344753099*^9}, {3.761218436512929*^9, 
   3.7612184391472597`*^9}, 3.761221499254425*^9, {3.7612215509824133`*^9, 
   3.761221595348377*^9}, {3.761222474734695*^9, 3.761222475321272*^9}, {
   3.761222623492916*^9, 3.761222626775672*^9}, {3.7612227750527687`*^9, 
   3.761222787927289*^9}, {3.761242469380966*^9, 3.761242477952352*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"465a8117-cb2c-4f70-98fb-0b7de1f74832"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r0N", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "4857276.10161231"}], ",", " ", "1842048.9943826", ",", " ", 
    "4023899.27495707"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.761242330423923*^9, 3.7612423401398277`*^9}, {
  3.761242393133493*^9, 3.7612423935465*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"bfbaa73d-c39e-4728-a2d7-75366c1839a4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4.85727610161231`*^6"}], ",", "1.8420489943826`*^6", ",", 
   "4.02389927495707`*^6"}], "}"}]], "Output",
 CellChangeTimes->{3.7612423410066357`*^9, 3.761242399435523*^9, 
  3.761242480106926*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"c95c6af3-4271-4861-9b0e-6982d2ac6d90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"centeredDipole", "[", "r0N", "]"}], "/", 
  RowBox[{"10", "^", "9"}]}]], "Input",
 CellChangeTimes->{{3.7612423491235533`*^9, 3.761242397416885*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"cad30bf0-4220-4397-9748-952550f5a086"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00003363477860608024`", ",", 
   RowBox[{"-", "0.000017256541744194185`"}], ",", "2.076305539569021`*^-6"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.761242354714856*^9, 3.761242401295356*^9}, 
   3.761242480917715*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"8ad74d48-3530-4307-8f59-7226453770cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1N", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "4878712.87028477"}], ",", " ", "1850178.56687341", " ", ",",
     "4041658.07559224"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.761242330423923*^9, 3.7612423401398277`*^9}, {
  3.761242393133493*^9, 3.7612423935465*^9}, {3.7612425021153927`*^9, 
  3.761242520890764*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"59ed12dd-0cc5-4307-97e8-73af33cb4954"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4.87871287028477`*^6"}], ",", "1.85017856687341`*^6", ",", 
   "4.04165807559224`*^6"}], "}"}]], "Output",
 CellChangeTimes->{3.7612423410066357`*^9, 3.761242399435523*^9, 
  3.761242480106926*^9, 3.7612425227724733`*^9},
 CellLabel->
  "Out[250]=",ExpressionUUID->"ee5f63c1-26f2-408f-bba9-df981ac83101"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"centeredDipole", "[", "r1N", "]"}], "/", 
  RowBox[{"10", "^", "9"}]}]], "Input",
 CellChangeTimes->{{3.7612423491235533`*^9, 3.761242397416885*^9}, {
  3.761242503692486*^9, 3.761242503756741*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"55711612-2f8c-40e9-be0f-1315ef2955e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0000331933563466706`", ",", 
   RowBox[{"-", "0.00001703006718535939`"}], ",", "2.0490561411640843`*^-6"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.761242354714856*^9, 3.761242401295356*^9}, 
   3.761242480917715*^9, 3.761242523618688*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"2f8095a1-ca87-401f-93c1-46dab0d0d486"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{540, 739},
WindowMargins->{{Automatic, 212}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 98, "Title",ExpressionUUID->"b3741299-3e65-425c-9750-98a2f5725af8"],
Cell[CellGroupData[{
Cell[771, 29, 169, 3, 67, "Section",ExpressionUUID->"dde990d1-6cd6-4ed8-bd65-f522b6c03d22"],
Cell[943, 34, 311, 7, 30, "Input",ExpressionUUID->"e3612ac8-4b7c-4257-bec1-d40f655621b2"],
Cell[CellGroupData[{
Cell[1279, 45, 165, 3, 54, "Subsection",ExpressionUUID->"24867fba-8e3d-40df-863f-ea8de3e0c6f3"],
Cell[1447, 50, 225, 5, 58, "Text",ExpressionUUID->"94accf41-55f4-4829-83e7-9ecfd8816b6c"],
Cell[1675, 57, 3507, 88, 367, "Input",ExpressionUUID->"6878ffd4-baee-4dba-af5f-d5f1a57ad4db"],
Cell[CellGroupData[{
Cell[5207, 149, 434, 11, 30, "Input",ExpressionUUID->"82ee7af1-ff7d-4fa6-9eda-c7b8fa079dde"],
Cell[5644, 162, 324, 5, 34, "Output",ExpressionUUID->"b70a4575-74cc-47ce-b7d6-2b6793485e15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6005, 172, 395, 10, 30, "Input",ExpressionUUID->"a5cdc0a9-ea0b-4a27-8828-b6531d15c1ef"],
Cell[6403, 184, 220, 4, 34, "Output",ExpressionUUID->"ae15ec63-8a0d-42bc-924f-f82f2b55cd97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6660, 193, 367, 9, 30, "Input",ExpressionUUID->"12eb5faa-31f8-422b-a7f5-bc8b3abe23cb"],
Cell[7030, 204, 243, 4, 34, "Output",ExpressionUUID->"b142b309-917e-482a-b6ea-ac0724521052"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7310, 213, 353, 10, 30, "Input",ExpressionUUID->"e0915515-3d9a-494d-84c9-83100a17d07d"],
Cell[7666, 225, 693, 19, 77, "Output",ExpressionUUID->"5b261804-dfb2-484b-82b2-c8c0c4dc41aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8396, 249, 345, 7, 30, "Input",ExpressionUUID->"a59826de-fc49-44d6-ab96-ce59de9b2e96"],
Cell[8744, 258, 450, 9, 34, "Output",ExpressionUUID->"e9f7e22f-f7bd-4e21-902b-df1436e5d56d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9231, 272, 272, 6, 30, "Input",ExpressionUUID->"31093fc9-15dd-4b86-8d46-502acb8cd725"],
Cell[9506, 280, 328, 8, 34, "Output",ExpressionUUID->"921544ce-ba09-41d6-9741-f129bb0b9044"]
}, Open  ]],
Cell[9849, 291, 371, 10, 30, "Input",ExpressionUUID->"67375f38-cb6f-45e0-9d5a-2bdf105b8de6"],
Cell[CellGroupData[{
Cell[10245, 305, 394, 7, 30, "Input",ExpressionUUID->"07fcd2a8-58d6-4596-b437-b114ab723d6e"],
Cell[10642, 314, 467, 10, 34, "Output",ExpressionUUID->"9653e53a-98c5-486f-a10e-779e5bbfa2ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11146, 329, 439, 12, 30, "Input",ExpressionUUID->"c6b679f5-cee4-42bb-851d-9a40de1be838"],
Cell[11588, 343, 511, 15, 60, "Output",ExpressionUUID->"0fffc7cd-558b-49b2-b65b-048af95e2c9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12136, 363, 263, 6, 30, "Input",ExpressionUUID->"fadc9278-7193-4c0b-b42c-87323b693e8d"],
Cell[12402, 371, 298, 7, 34, "Output",ExpressionUUID->"9124b1a6-78bf-4ec1-ab94-1be84afd3258"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12749, 384, 214, 4, 54, "Subsection",ExpressionUUID->"8f6aa3f4-1f72-4525-96ae-4c0ba2c6e956"],
Cell[12966, 390, 207, 3, 30, "Input",ExpressionUUID->"5e9a2f52-e785-444f-b9a1-2ce480cf6dae"],
Cell[13176, 395, 2004, 46, 241, "Input",ExpressionUUID->"8ba81c4b-319a-4ca6-8478-32dd93a469ed"],
Cell[CellGroupData[{
Cell[15205, 445, 295, 6, 30, "Input",ExpressionUUID->"64c7ef8a-3115-4700-8014-b69fe63b8f36"],
Cell[15503, 453, 672, 14, 34, "Output",ExpressionUUID->"0d6a2877-d47a-414d-b09a-b90d4a5c5507"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16212, 472, 351, 7, 30, "Input",ExpressionUUID->"f50b92a1-7846-4430-ac31-0c53c26d145c"],
Cell[16566, 481, 395, 9, 34, "Output",ExpressionUUID->"7d5d20cb-dc90-4465-8ca7-49ba25eb5274"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16998, 495, 180, 3, 30, "Input",ExpressionUUID->"c16762c2-d5c7-48c2-a496-baf8b29070b9"],
Cell[17181, 500, 225, 5, 37, "Output",ExpressionUUID->"eb8a2fca-957d-426c-b50d-6f81cb337cf0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17467, 512, 152, 3, 67, "Section",ExpressionUUID->"8af01b86-4351-4f0f-b5dc-3849b8cd0f6b"],
Cell[17622, 517, 2050, 46, 241, "Input",ExpressionUUID->"465a8117-cb2c-4f70-98fb-0b7de1f74832"],
Cell[CellGroupData[{
Cell[19697, 567, 395, 9, 52, "Input",ExpressionUUID->"bfbaa73d-c39e-4728-a2d7-75366c1839a4"],
Cell[20095, 578, 336, 8, 37, "Output",ExpressionUUID->"c95c6af3-4271-4861-9b0e-6982d2ac6d90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20468, 591, 267, 6, 30, "Input",ExpressionUUID->"cad30bf0-4220-4397-9748-952550f5a086"],
Cell[20738, 599, 346, 8, 37, "Output",ExpressionUUID->"8ad74d48-3530-4307-8f59-7226453770cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21121, 612, 447, 10, 52, "Input",ExpressionUUID->"59ed12dd-0cc5-4307-97e8-73af33cb4954"],
Cell[21571, 624, 361, 8, 37, "Output",ExpressionUUID->"ee5f63c1-26f2-408f-bba9-df981ac83101"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21969, 637, 316, 7, 30, "Input",ExpressionUUID->"55711612-2f8c-40e9-be0f-1315ef2955e9"],
Cell[22288, 646, 367, 8, 71, "Output",ExpressionUUID->"2f8095a1-ca87-401f-93c1-46dab0d0d486"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

