

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>scenario_AddRWFault &mdash; Basilisk 2.9.0
 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=57a44e8a" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=182a64a0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=3cd7d658"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CFB87C" >

          
          
          <a href="../index.html" class="icon icon-home">
            Basilisk
              <img src="../_static/Basilisk-Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basilisk:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Build.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Learn.html">Learning Basilisk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supportData.html">Support Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExternalSites.html">External Sites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vizard:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/Vizard.html">About Vizard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardDownload.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/VizardGUI.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/vizardAdvanced/index.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vizard/vizardGallery.html">Video Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #CFB87C" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Basilisk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">scenario_AddRWFault</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for scenario_AddRWFault</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  ISC License</span>
<span class="c1">#</span>
<span class="c1">#  Copyright (c) 2016, Autonomous Vehicle Systems Lab, University of Colorado at Boulder</span>
<span class="c1">#</span>
<span class="c1">#  Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="c1">#  purpose with or without fee is hereby granted, provided that the above</span>
<span class="c1">#  copyright notice and this permission notice appear in all copies.</span>
<span class="c1">#</span>
<span class="c1">#  THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="c1">#  WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="c1">#  MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="c1">#  ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="c1">#  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="c1">#  ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="c1">#  OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="c1">#</span>
<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Overview</span>
<span class="sd">--------</span>

<span class="sd">This script demonstrates how to use event handlers to add reaction wheel faults. The script is found in the folder ``basilisk/examples/BskSim/scenarios`` and executed by using::</span>

<span class="sd">      python3 scenario_AddRWFault.py</span>

<span class="sd">Using event handlers</span>
<span class="sd">--------------------</span>

<span class="sd">The event handler class, defined in ``SimulationBaseClass``, allows the user to define events. These events can be used for a variety of reasons, ranging from changing flight modes to creating faults. The events used in this example are defined in ``BSK_Dynamics``.</span>

<span class="sd">When creating an event handler, the following syntax is used::</span>

<span class="sd">    SimBase.createNewEvent(&quot;eventName&quot;, eventRate, eventActive,</span>
<span class="sd">        conditionFunction=lambda self: False, actionFunction = lambda self: None)</span>

<span class="sd">Within the condition list should be the conditions for executing the event, specified as strings. Likewise, the action list enumerates strings that are executed when the event happens. Because the code parses these strings, rather than having complex conditions or actions in the string literals, it can be convenient to create methods (see the examples below).</span>

<span class="sd">By default, after the event has happened once, the eventActive flag is turned to false. For repeated events, this behavior can be overriden by calling the function ``setEventActivity``. Likewise, the eventActive flags of other events can be set using ``setAllButCurrentEventActivity``. See the associated documentation for more details.</span>

<span class="sd">Setting up the faults</span>
<span class="sd">---------------------</span>

<span class="sd">This script uses two event handlers. The first one defines an event that injects a large, one-time static friction fault::</span>

<span class="sd">        def action_oneTimeRWFault(self):</span>
<span class="sd">            self.DynModels.AddRWFault(&quot;friction&quot;, 0.05, 1, self.TotalSim.CurrentNanos)</span>
<span class="sd">            self.oneTimeRWFaultFlag = 0</span>

<span class="sd">        SimBase.createNewEvent(</span>
<span class="sd">            &quot;addOneTimeRWFault&quot;,</span>
<span class="sd">            self.processTasksTimeStep,</span>
<span class="sd">            True,</span>
<span class="sd">            conditionFunction=lambda self: (</span>
<span class="sd">                self.TotalSim.CurrentNanos &gt;= self.oneTimeFaultTime</span>
<span class="sd">                and self.oneTimeRWFaultFlag == 1</span>
<span class="sd">            ),</span>
<span class="sd">            actionFunction=action_oneTimeRWFault,</span>
<span class="sd">        )</span>


<span class="sd">For this event, the conditions are that the time for the fault has passed, and that the corresponding fault flag is active. The fault time is specified in the scenario script. The ``oneTimeRWFaultFlag`` and the ``repeatRWFaultFlag``, also set in the scenario script, ensures that the faults are added only for the fault scenario.</span>

<span class="sd">The second event handler defines an event that is always active, and adds a smaller static friction fault with small probability::</span>

<span class="sd">        def action_repeatedRWFault(self):</span>
<span class="sd">            self.DynModels.PeriodicRWFault(</span>
<span class="sd">                1.0 / 3000, &quot;friction&quot;, 0.005, 1, self.TotalSim.CurrentNanos</span>
<span class="sd">            )</span>
<span class="sd">            self.setEventActivity(&quot;addRepeatedRWFault&quot;, True)</span>

<span class="sd">        SimBase.createNewEvent(</span>
<span class="sd">            &quot;addRepeatedRWFault&quot;,</span>
<span class="sd">            self.processTasksTimeStep,</span>
<span class="sd">            True,</span>
<span class="sd">            conditionFunction=lambda self: self.repeatRWFaultFlag == 1,</span>
<span class="sd">            actionFunction=action_repeatedRWFault,</span>
<span class="sd">        )</span>

<span class="sd">Note the command ``&quot;self.setEventActivity(&#39;addRepeatedRWFault&#39;,True)&quot;``, keeping the eventActive flag turned on for this event handler. For both event handlers, the particular methods that change the reaction wheel friction parameters are defined in ``BSK_Dynamics``.</span>

<span class="sd">Illustration of Simulation Results</span>
<span class="sd">----------------------------------</span>

<span class="sd">::</span>

<span class="sd">    showPlots = True</span>

<span class="sd">.. image:: /_images/Scenarios/scenario_AddRWFault_rateError.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenario_AddRWFault_attitudeErrorNorm.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenario_AddRWFault_RWSpeeds.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">.. image:: /_images/Scenarios/scenario_AddRWFault_RWFriction.svg</span>
<span class="sd">   :align: center</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Get current file path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Basilisk.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">macros</span><span class="p">,</span> <span class="n">orbitalMotion</span>

<span class="n">filename</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span><span class="o">.</span><span class="n">filename</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

<span class="c1"># Import master classes: simulation base class and scenario base class</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/../&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/../models&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/../plotting&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">BSK_Dynamics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">BSK_Fsw</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">BSK_Plotting</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">BSK_plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">BSK_masters</span><span class="w"> </span><span class="kn">import</span> <span class="n">BSKScenario</span><span class="p">,</span> <span class="n">BSKSim</span>


<span class="c1"># Create your own scenario child class</span>
<div class="viewcode-block" id="scenario_AddRWFault">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.scenario_AddRWFault">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">scenario_AddRWFault</span><span class="p">(</span><span class="n">BSKSim</span><span class="p">,</span> <span class="n">BSKScenario</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">scenario_AddRWFault</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;scenario_AddRWFault&#39;</span>

        <span class="c1"># declare additional class variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sNavTransName</span> <span class="o">=</span> <span class="s2">&quot;sNavTransMsg&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attGuidName</span> <span class="o">=</span> <span class="s2">&quot;attGuidMsg&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_DynModel</span><span class="p">(</span><span class="n">BSK_Dynamics</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_FswModel</span><span class="p">(</span><span class="n">BSK_Fsw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">configure_initial_conditions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_outputs</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oneTimeRWFaultFlag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeatRWFaultFlag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oneTimeFaultTime</span> <span class="o">=</span> <span class="n">macros</span><span class="o">.</span><span class="n">min2nano</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>

        <span class="n">DynModels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_DynModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DynModels</span><span class="o">.</span><span class="n">RWFaultLog</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="scenario_AddRWFault.configure_initial_conditions">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.scenario_AddRWFault.configure_initial_conditions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">configure_initial_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Configure Dynamics initial conditions</span>
        <span class="n">oe</span> <span class="o">=</span> <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">ClassicElements</span><span class="p">()</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">10000000.0</span>  <span class="c1"># meters</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mf">33.3</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">D2R</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">Omega</span> <span class="o">=</span> <span class="mf">48.2</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">D2R</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="mf">347.8</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">D2R</span>
        <span class="n">oe</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="mf">85.3</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">D2R</span>

        <span class="n">DynModels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_DynModel</span><span class="p">()</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">DynModels</span><span class="o">.</span><span class="n">gravFactory</span><span class="o">.</span><span class="n">gravBodies</span><span class="p">[</span><span class="s1">&#39;earth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">rN</span><span class="p">,</span> <span class="n">vN</span> <span class="o">=</span> <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">elem2rv</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">oe</span><span class="p">)</span>
        <span class="n">orbitalMotion</span><span class="o">.</span><span class="n">rv2elem</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">rN</span><span class="p">,</span> <span class="n">vN</span><span class="p">)</span>
        <span class="n">DynModels</span><span class="o">.</span><span class="n">scObject</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">r_CN_NInit</span> <span class="o">=</span> <span class="n">rN</span>  <span class="c1"># m   - r_CN_N</span>
        <span class="n">DynModels</span><span class="o">.</span><span class="n">scObject</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">v_CN_NInit</span> <span class="o">=</span> <span class="n">vN</span>  <span class="c1"># m/s - v_CN_N</span>
        <span class="n">DynModels</span><span class="o">.</span><span class="n">scObject</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">sigma_BNInit</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">]]</span>  <span class="c1"># sigma_BN_B</span>
        <span class="n">DynModels</span><span class="o">.</span><span class="n">scObject</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">omega_BN_BInit</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.001</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">]]</span>  <span class="c1"># rad/s - omega_BN_B</span></div>


<div class="viewcode-block" id="scenario_AddRWFault.log_outputs">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.scenario_AddRWFault.log_outputs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">FswModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_FswModel</span><span class="p">()</span>
        <span class="n">DynModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_DynModel</span><span class="p">()</span>
        <span class="n">samplingTime</span> <span class="o">=</span> <span class="n">FswModel</span><span class="o">.</span><span class="n">processTasksTimeStep</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rwSpeedRec</span> <span class="o">=</span> <span class="n">DynModel</span><span class="o">.</span><span class="n">rwStateEffector</span><span class="o">.</span><span class="n">rwSpeedOutMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">(</span><span class="n">samplingTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">DynModel</span><span class="o">.</span><span class="n">taskName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rwSpeedRec</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attGuidName</span><span class="p">]</span> <span class="o">=</span> <span class="n">FswModel</span><span class="o">.</span><span class="n">attGuidMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">(</span><span class="n">samplingTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">DynModel</span><span class="o">.</span><span class="n">taskName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attGuidName</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sNavTransName</span><span class="p">]</span> <span class="o">=</span> <span class="n">DynModel</span><span class="o">.</span><span class="n">simpleNavObject</span><span class="o">.</span><span class="n">transOutMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">(</span><span class="n">samplingTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">DynModel</span><span class="o">.</span><span class="n">taskName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sNavTransName</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rwLogs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rwLogs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DynModel</span><span class="o">.</span><span class="n">rwStateEffector</span><span class="o">.</span><span class="n">rwOutMsgs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">recorder</span><span class="p">(</span><span class="n">samplingTime</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="n">DynModel</span><span class="o">.</span><span class="n">taskName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rwLogs</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="scenario_AddRWFault.pull_outputs">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.scenario_AddRWFault.pull_outputs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pull_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">showPlots</span><span class="p">):</span>
        <span class="c1"># FSW process outputs, remove first data point as it is before FSW is called</span>
        <span class="n">attErrRec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msgRecList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attGuidName</span><span class="p">]</span>

        <span class="n">sigma_BR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">attErrRec</span><span class="o">.</span><span class="n">sigma_BR</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">omega_BR_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">attErrRec</span><span class="o">.</span><span class="n">omega_BR_B</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">num_RW</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">RW_speeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rwSpeedRec</span><span class="o">.</span><span class="n">wheelSpeeds</span><span class="p">[:,</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_RW</span><span class="p">)],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">RW_friction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_RW</span><span class="p">):</span>
            <span class="n">RW_friction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rwLogs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">u_f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># Plot results</span>
        <span class="n">BSK_plt</span><span class="o">.</span><span class="n">clear_all_plots</span><span class="p">()</span>
        <span class="n">timeData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">attErrRec</span><span class="o">.</span><span class="n">times</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">macros</span><span class="o">.</span><span class="n">NANO2MIN</span>
        <span class="n">BSK_plt</span><span class="o">.</span><span class="n">plot_attitude_error</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">sigma_BR</span><span class="p">)</span>
        <span class="n">BSK_plt</span><span class="o">.</span><span class="n">plot_rate_error</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">omega_BR_B</span><span class="p">)</span>
        <span class="n">BSK_plt</span><span class="o">.</span><span class="n">plot_rw_speeds</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">RW_speeds</span><span class="p">,</span> <span class="n">num_RW</span><span class="p">)</span>
        <span class="n">BSK_plt</span><span class="o">.</span><span class="n">plot_rw_friction</span><span class="p">(</span><span class="n">timeData</span><span class="p">,</span> <span class="n">RW_friction</span><span class="p">,</span> <span class="n">num_RW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DynModels</span><span class="o">.</span><span class="n">RWFaultLog</span><span class="p">)</span>

        <span class="n">figureList</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">showPlots</span><span class="p">:</span>
            <span class="n">BSK_plt</span><span class="o">.</span><span class="n">show_all_plots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">figureNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attitudeErrorNorm&quot;</span><span class="p">,</span> <span class="s2">&quot;rateError&quot;</span><span class="p">,</span> <span class="s2">&quot;RWSpeeds&quot;</span><span class="p">,</span> <span class="s2">&quot;RWFriction&quot;</span><span class="p">]</span>
            <span class="n">figureList</span> <span class="o">=</span> <span class="n">BSK_plt</span><span class="o">.</span><span class="n">save_all_plots</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">figureNames</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figureList</span></div>
</div>



<div class="viewcode-block" id="runScenario">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.runScenario">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">runScenario</span><span class="p">(</span><span class="n">scenario</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;method to initialize and execute the scenario&quot;&quot;&quot;</span>

    <span class="n">simulationTime</span> <span class="o">=</span> <span class="n">macros</span><span class="o">.</span><span class="n">min2nano</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
    <span class="n">scenario</span><span class="o">.</span><span class="n">modeRequest</span> <span class="o">=</span> <span class="s2">&quot;hillPoint&quot;</span>

    <span class="c1"># Run the simulation</span>
    <span class="n">scenario</span><span class="o">.</span><span class="n">InitializeSimulation</span><span class="p">()</span>
    <span class="n">scenario</span><span class="o">.</span><span class="n">ConfigureStopTime</span><span class="p">(</span><span class="n">simulationTime</span><span class="p">)</span>
    <span class="n">scenario</span><span class="o">.</span><span class="n">ExecuteSimulation</span><span class="p">()</span>

    <span class="k">return</span></div>



<div class="viewcode-block" id="run">
<a class="viewcode-back" href="../examples/BskSim/scenarios/scenario_AddRWFault.html#scenario_AddRWFault.run">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">showPlots</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The scenarios can be run with the following parameters:</span>

<span class="sd">        Args:</span>
<span class="sd">            showPlots (bool): Determines if the script should display plots</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scenario</span> <span class="o">=</span> <span class="n">scenario_AddRWFault</span><span class="p">()</span>
    <span class="n">runScenario</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
    <span class="n">figureList</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">pull_outputs</span><span class="p">(</span><span class="n">showPlots</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">figureList</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Autonomous Vehicle Systems (AVS) Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>