

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>test_effectorBranching_integrated &mdash; Basilisk 2.8.41
 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css?v=57a44e8a" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=53003e83"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../../../_static/copybutton.js?v=3cd7d658"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="constraintEffector" href="../../constraintEffector/index.html" />
    <link rel="prev" title="_UnitTestDynamics" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CFB87C" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            Basilisk
              <img src="../../../../../_static/Basilisk-Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basilisk:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Build.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Learn.html">Learning Basilisk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Support.html">Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../architecture/index.html">architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../fswAlgorithms/index.html">fswAlgorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../moduleTemplates/index.html">moduleTemplates</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">simulation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../communication/index.html">communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../deviceInterface/index.html">deviceInterface</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">dynamics</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../DynOutput/index.html">DynOutput</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ExtPulsedTorque/index.html">ExtPulsedTorque</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../FuelTank/index.html">FuelTank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GravityGradientEffector/index.html">GravityGradientEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../HingedRigidBodies/index.html">HingedRigidBodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Integrators/index.html">Integrators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../LinearSpringMassDamper/index.html">LinearSpringMassDamper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../MtbEffector/index.html">MtbEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../NHingedRigidBodies/index.html">NHingedRigidBodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../RadiationPressure/index.html">RadiationPressure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Thrusters/index.html">Thrusters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../VSCMGs/index.html">VSCMGs</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">_GeneralModuleFiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../constraintEffector/index.html">constraintEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragEffector/index.html">dragEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dualHingedRigidBodies/index.html">dualHingedRigidBodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../extForceTorque/index.html">extForceTorque</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../facetDragEffector/index.html">facetDragEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../facetSRPDynamicEffector/index.html">facetSRPDynamicEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../gravityEffector/index.html">gravityEffector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hingedRigidBodyMotor/index.html">hingedRigidBodyMotor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../linearTranslationalBodies/index.html">linearTranslationalBodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../msmForceTorque/index.html">msmForceTorque</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../prescribedMotion/index.html">prescribedMotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reactionWheels/index.html">reactionWheels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spacecraft/index.html">spacecraft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spacecraftSystem/index.html">spacecraftSystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../sphericalPendulum/index.html">sphericalPendulum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spinningBodies/index.html">spinningBodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stateArchitecture/index.html">stateArchitecture</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../environment/index.html">environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mujocoDynamics/index.html">mujocoDynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../navigation/index.html">navigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../onboardDataHandling/index.html">onboardDataHandling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../power/index.html">power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sensors/index.html">sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../simSynch/index.html">simSynch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../thermal/index.html">thermal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../vizard/index.html">vizard</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../utilities/index.html">utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../supportData.html">Support Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ExternalSites.html">External Sites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vizard:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/Vizard.html">About Vizard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/VizardDownload.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/VizardReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/VizardGUI.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/vizardAdvanced/index.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Vizard/vizardGallery.html">Video Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #CFB87C" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Basilisk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Documentation</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">simulation</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">dynamics</a></li>
          <li class="breadcrumb-item"><a href="../index.html">_GeneralModuleFiles</a></li>
          <li class="breadcrumb-item"><a href="index.html">_UnitTestDynamics</a></li>
      <li class="breadcrumb-item active">test_effectorBranching_integrated</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/Documentation/simulation/dynamics/_GeneralModuleFiles/_UnitTestDynamics/test_effectorBranching_integrated.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="test-effectorbranching-integrated">
<span id="id1"></span><h1>test_effectorBranching_integrated<a class="headerlink" href="#test-effectorbranching-integrated" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="py function" id="module-test_effectorBranching_integrated">
<dt class="sig sig-object py" id="test_effectorBranching_integrated.test_effectorBranchingIntegratedTest">
<span class="sig-prename descclassname"><span class="pre">test_effectorBranching_integrated.</span></span><span class="sig-name descname"><span class="pre">test_effectorBranchingIntegratedTest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_plots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stateEffector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isParent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamicEffector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isChild</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/test_effectorBranching_integrated.html#test_effectorBranchingIntegratedTest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#test_effectorBranching_integrated.test_effectorBranchingIntegratedTest" title="Link to this definition"></a></dt>
<dd><p><strong>Validation Test Description</strong></p>
<p>This integrated test sets up combinations of dynamic effector attached to a state effector.</p>
<p><strong>Description of Variables Being Tested</strong></p>
<p>In this file we are checking first for branching compatibility, as not every state effector is
set up to host dependent effectors (isParent), and not every dynamic effector is set up to be
attached to a state effector (isChild). The state effector compatibility is checked when the
addDynamicEffector() method is called. The dynamic effector compatibility is checked at
simulation initialization when linkInProperties() is called.</p>
<p>A summary of which state effectors and dynamic effectors are expected to be able to act as a
parent or child effector to another is summarized in <a class="reference internal" href="../../../../../Learn/bskPrinciples/bskPrinciples-11.html#bskprinciples-11"><span class="std std-ref">Advanced: Effector Module Branching</span></a>.</p>
<p>Note that the constraint effector is tested in two configurations: once where one vehicle’s
state effector is attached to the hub on another vehicle (<code class="docutils literal notranslate"><span class="pre">constraintEffectorOneHub</span></code>), and
once where both vehicles’ state effectors are attached to each other
(<code class="docutils literal notranslate"><span class="pre">constraintEffectorNoHubs</span></code>). Additionally, a test with multiple dynamic effectors attached
to a single state effector is included (<code class="docutils literal notranslate"><span class="pre">multiEffector</span></code>). Finally, at least one non-compatible
state effector and one non-compatible dynamic effector are included to check that the error
handling catches as expected.</p>
<p>Note that the center of mass of the hub is adjusted to balance the shift in total vehicle COM
due to the addition of the state effector’s mass. This adjustment is calculated such that at
simulation initialization the total center of mass of the vehicle is coincident with the hub’s
body frame B (r_BN_N = r_CN_N). This greatly simplifies the setup of the constraint effector
branching scenarios. This calculation is performed by calculating the parameter mr_PcB_B in each
state effector’s setup method which for the state effector’s series of <span class="math notranslate nohighlight">\(i\)</span> bodies is:</p>
<div class="math notranslate nohighlight">
\[\sum_i m_{P_i} {}^{\mathcal{B}}\mathbf{r}_{Pc_i/B}\]</div>
<p>Where P is the state effector’s designation as “parent”, with each of its <span class="math notranslate nohighlight">\(i\)</span> segments
having segment body fixed frame <span class="math notranslate nohighlight">\(\mathcal{P}_i\)</span>, origin <span class="math notranslate nohighlight">\(P_i\)</span>, and segment center of
mass <span class="math notranslate nohighlight">\(Pc_i\)</span>. Then used to compute the hub center of mass offset scObject.hub.r_BcB_B as:</p>
<div class="math notranslate nohighlight">
\[{}^{\mathcal{B}}\mathbf{r}_{Bc/B} =
\frac{- \sum_i m_{P_i} {}^{\mathcal{B}}\mathbf{r}_{Pc_i/B}} {\sum_i m_{Bc}}\]</div>
<p>In the case of a permissible combination, we then check that properties are being handed
correctly from the state effector to dynamic effector.</p>
<p>These variables include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inertialPositionProperty</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inertialVelocityProperty</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inertialAttitudeProperty</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inertialAngVelocityProperty</span></code></p></li>
</ul>
<p>Finally, we simultaneously check that a) the applied force and torque are being handed correctly
from the dynamic effector to state effector, and b) that these forces and torques are
implemented correctly in the state effector’s equations of motion. We do this by isolating each
case where a state effector has the <a class="reference internal" href="../../extForceTorque/extForceTorque.html#extforcetorque"><span class="std std-ref">Module: extForceTorque</span></a> effector attached to it. Using the
explicitly defined <code class="docutils literal notranslate"><span class="pre">forceExternal_B</span></code> and <code class="docutils literal notranslate"><span class="pre">torqueExternalPntB_B</span></code> and the logged inertial
position and attitude properties of the state effector, we manually compute the total external
force on the vehicle about the combined center of mass and the accumulated delta V of the
vehicle’s combined center of mass. The torque is then integrated using a trapezoid rule and
compared against the spacecraft’s internally computed angular momentum.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{}^{\mathcal{N}}\!\Delta\mathbf{H}_{C}
&amp; = \int_{t_0}^{t} {}^{\mathcal{N}}\!\boldsymbol{\tau}_{\text{ext},C}(t)\,dt \\
&amp; = \int_{t_0}^{t} \text{Pure Torque + Force Relative to COM} \\
&amp; = \int_{t_0}^{t} [\mathcal{NP}_j] {}^{\mathcal{P}_j}\!\boldsymbol{\tau}_{\text{ext},P_j}
  + \left( {}^{\mathcal{N}}\mathbf{r}_{Pc_j/N}
  - [\mathcal{NP}_j] {}^{\mathcal{P}_j}\mathbf{r}_{Pc_j/P_j}
  - {}^{\mathcal{N}}\mathbf{r}_{C/N} \right)
  \times \left( [\mathcal{NP}_j] {}^{\mathcal{P}_j}\mathbf{F}_{P_j} \right)\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(j\)</span> is the segment that the dynamic effector is attached to. The sim ‘truth’
<span class="math notranslate nohighlight">\({}^{\mathcal{N}}\!\Delta\mathbf{H}_{C}\)</span> (scObject.totOrbAngMomPntN_N) and
<span class="math notranslate nohighlight">\({}^{\mathcal{N}}\mathbf{r}_{C/N}\)</span> are logged from the spacecraft module. Exerted
<span class="math notranslate nohighlight">\({}^{\mathcal{P}_j}\!\boldsymbol{\tau}_{\text{ext},P_j}\)</span> and
<span class="math notranslate nohighlight">\({}^{\mathcal{P}_j}\mathbf{F}_{P_j}\)</span> are from the extForceTorque effector module.
<span class="math notranslate nohighlight">\({}^{\mathcal{N}}\mathbf{r}_{Pc_j/N}\)</span>, <span class="math notranslate nohighlight">\([\mathcal{NP}_j]\)</span>, and
<span class="math notranslate nohighlight">\({}^{\mathcal{P}_j}\mathbf{r}_{Pc_j/P_j}\)</span> come from the state effector module.</p>
<p>The accumulated delta V is compared against the internally computed delta V of the spacecraft
center of mass.</p>
<div class="math notranslate nohighlight">
\[{}^{\mathcal{N}}\!\Delta v_{accum,C} = \int_{t_0}^{t} \frac{[\mathcal{NP}_j]
{}^{\mathcal{P}_j}\mathbf{F}_{P_j}} {m_{Bc} + \sum_i m_{P_i}} dt\]</div>
<p>where again <span class="math notranslate nohighlight">\(j\)</span> is the segment that the dynamic effector is attached to among all
<span class="math notranslate nohighlight">\(i\)</span> segments. The sim ‘truth’ <span class="math notranslate nohighlight">\({}^{\mathcal{N}}\!\Delta v_{accum,C}\)</span> is logged from
the spacecraft module.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="_UnitTestDynamics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../constraintEffector/index.html" class="btn btn-neutral float-right" title="constraintEffector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Autonomous Vehicle Systems (AVS) Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>